swagger: '2.0'
info:
  version: '0.1'
  title: 'cmu mars brass th: phase 2, cp2'
schemes:
  - http
host: brass-th

definitions:
  CandidateAdaptation:
    type: object

paths:
  /error:
    post:
      description: |-
        Used to indicate that an error has occurred during the preparation
        or evaluation of a test scenario, or during the start-up of the
        system under test. The body of this method contains a single
        property, `ErrorMsg`, containing a JSON-based description of the
        error. A description of the errors produced by SUT is given
        below.
      parameters:
        - in: body
          name: Parameters
          schema:
            type: object
            required:
              - err-code
            properties:
              err-code:
                type: string
                enum:
                  - NeutralPerturbation
                description: >-
                  One of the perturbations for the test scenario has no
                  effect on the outcome of the test suite, and as such, it
                  does not consistitute a fault

                  TODO -- add more error codes with more description of
                  possible bad states
      responses:
        '200':
          description: the TH acknowledges the error
        '400':
          description: the TH has itself encountered an error processing the error
  /ready:
    post:
      description: >-
        Used to indicate that the SUT is ready and that testing may begin.
      responses:
        '200':
          description: the TH acknowledges the ready message
        '400':
          description: the TH has itself encontered an error processing the ready message
  /status:
    post:
      description: >-
        Used to inform the test harness that a new adaptation has been added to
        the Pareto set (i.e., a new "best" adaptation has been found). TODO --
        add parameters here?
      responses:
        '200':
          description: the TH acknowledges the status
        '400':
          description: the TH has itself encontered an error processing the status
  /done:
    post:
      description: >-
        Used to indicate that evaluation of the test scenario has been
        completed. A summary of the results of the test scenario are provided as
        a JSON object. The entire summary is contained within
        `SutFinishedStatus`, as specified by the Lincoln Labs API.
      parameters:
        - in: body
          name: Parameters
          schema:
            type: object
            required:
              - outcome
              - running-time
              - num-attempts
              - pareto-set
              - log
            properties:
              outcome:
                type: string
                description: >-
                  A short description of the success of the repair process TODO
                  -- in the md, Chris had this as an enum but without values
                  listed
              running-time:
                type: number
                format: float
                description: >-
                  The number of minutes taken to complete the repair process.
              num-attempts:
                type: integer
                description: >-
                  The number of code adaptations attempted.
              pareto-set:
                type: array
                items:
                  $ref: '#/definitions/CandidateAdaptation'
                description: >-
                  A list containing details of all adaptations within the
                  pareto set.
              log:
                type: array
                items:
                  $ref: '#/definitions/CandidateAdaptation'
                description: >-
                  A list containing details of each of the attempted repairs.
      responses:
        '200':
          description: the TH acknowledges the done message
        '400':
          description: the TH has itself encontered an error processing the done message
